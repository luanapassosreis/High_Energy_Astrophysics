%  ---------------------------- identification  ---------------------------
\NeedsTeXFormat{LaTeX2e}
\ProvidesClass{lstproposal}[2014/07/02 LaTeX2e class for creating the scientific/technical rationale for LST proposals]

% --------------------------- processing options --------------------------
\DeclareOption* {\PassOptionsToClass{\CurrentOption}{article}}
\PassOptionsToClass{a4paper}{article}
\ProcessOptions \relax

% -------------------------- extend article class -------------------------
\LoadClass{article}

% ------------------------------- main code -------------------------------
\usepackage{framed}
\usepackage{xparse}

\pagestyle{empty}

% Set some lengths.
% Please don't change these values.
\textwidth16.4cm
\FrameSep0.3cm
\oddsidemargin-0.24cm
\textheight23.6cm
\topmargin-1.8cm
\parindent0mm

\newlength{\PageTextwidth}
\setlength{\PageTextwidth}{\textwidth}
	
\newlength{\ReferenceColumnWidth}
\setlength{\ReferenceColumnWidth}{7.5cm}
	
\newlength{\ReferenceColumnGap}
\setlength{\ReferenceColumnGap}{\PageTextwidth}
\addtolength{\ReferenceColumnGap}{-2\FrameSep}
\addtolength{\ReferenceColumnGap}{-2\ReferenceColumnWidth}

% A pair of references.
\newcommand{\ReferencePair}[2]
	{
		\noindent\parbox[t]{\ReferenceColumnWidth}{#1}\hspace{\ReferenceColumnGap}\parbox[t]{\ReferenceColumnWidth}{#2}
	}
	
% A fancy framed box containing a section.
\newenvironment{SectionBox}[2]
	{
		\begin{framed}
			\hspace*{1mm}\\[-1.7ex]
			\noindent\textbf{\theSectionBoxCounter\stepcounter{SectionBoxCounter}.\hspace{1cm}#1}\\
			{\em #2}\\[-1ex]
			\hspace*{-\FrameSep}\rule[0pt]{\PageTextwidth}{0.4pt}\\[0.3ex]
			\noindent
	}
	{
		\end{framed}
	}
	
% Counter for the section boxes.
\newcounter{SectionBoxCounter}
\setcounter{SectionBoxCounter}{1}

% % A framed boxed containing an introduction.
% \newcommand{\Introduction}[3]
% 	{
% 		\begin{framed}
% 			\hspace*{1mm}\\[-1.7ex]
% 			\noindent\textbf{The following sections have been generated by the PI using version #1 of the template for #2. The page limit for these sections is #3 $\times$ A4 pages. Font size should not be less than 10 points.}\\[-3ex]	
% 		\end{framed}
% 	}


% A framed boxed containing an introduction.
\newcommand{\Title}[1]
	{
		\begin{framed}
			\hspace*{1mm}\\[-1.7ex]
			\noindent \textbf{\Large#1} \\[-3ex]
		\end{framed}
	}

\newcommand{\Group}[1]
	{
		\begin{framed}
			\hspace*{1mm}\\[-1.7ex]
			\noindent \textbf{Group}: #1 \\[-3ex]
		\end{framed}
	}


\newcommand{\MAGIC}[3]
	{
		\begin{SectionBox}
                    {MAGIC PROPOSAL}
                    {This section contains information on any parallel MAGIC proposal requesting LST data.}            
			% \hspace*{1mm}\\[-1.7ex]
                \textbf{Is there a parallel MAGIC+LST Proposal? [Yes/No]} : #1 \\ [1ex]
                \hspace*{10mm} \textbf{If yes, please provide MAGIC proposal ID} = #2 \\ [1ex]
                \textbf{Will this require joint MAGIC+LST analysis? [Yes/No/Maybe]} = #3 \\[-2ex]
            \end{SectionBox}
	}

\newcommand{\Source}[9]
	{
		\begin{framed}
			% \hspace*{1mm}\\[-1.7ex]
			\noindent \textbf{Source Name}: #1 \\[1ex]
                \hspace*{5mm} \textbf{RA [deg]} = #2, \textbf{DEC [deg]} = #3 \\[1ex]
                \hspace*{5mm} \textbf{Min Zenith [deg]} = #4, \textbf{Max Zenith [deg]} = #5 \\[1ex]
                \hspace*{5mm} \textbf{Night Sky Background [Moon/Dark/Both]} = #6 \\[1ex]
                \hspace*{5mm} \textbf{Wobbles [Standard/Custom]} = #7 \\[1ex]
                \hspace*{5mm} \textbf{Observation Time [hrs]} = #8 \\[1ex]
                \hspace*{5mm} \textbf{Observation Type} = #9 \\[-2ex]
            \end{framed}
	}

% A framed boxed containing an introduction.
\newcommand{\PI}[3]
	{
		\begin{framed}
			\noindent \textbf{PI of Proposal:} #1, \textbf{Institute:} #2, \textbf{Email:} #3 \\[-3ex]	
		\end{framed}
	}

\newcommand{\COI}[3]
	{
		\begin{framed}
			\noindent \textbf{CoI of Proposal:} #1, \textbf{Institute:} #2, \textbf{Email:} #3 \\[-3ex]	
		\end{framed}
	}

% A framed box containing the scientific rationale.
\newcommand{\ScientificRationale}[2]
	{
		\begin{SectionBox}
			{SCIENTIFIC RATIONALE}
			{Discuss the scientific background and aims of the proposal and why you want to make these observations. This section should not exceed #1 words. Figures and graphics can be included, or appended in Section 5.}
			{#2}
		\end{SectionBox}
	}

% A framed box containing the scientific rationale.
\newcommand{\MAGICRationale}[2]
	{
		\begin{SectionBox}
			{MAGIC+LST RATIONALE}
			{If this proposal is linked to a current MAGIC+LST proposal, as listed in the previous section, please use this section to describe the rationale for requesting time in both from a MAGIC+LST proposal and an independent LST mono proposal. This section should not exceed #1 words. Also, include the name and code of MAGIC proposal below.  }
			{#2}
		\end{SectionBox}
	}

% A framed box containing the immediate objectives.
\newcommand{\PublicationPlans}[2]
	{
		\begin{SectionBox}
			{PUBLICATION PLANS}
			{Present the plan of how you will use the data you will gather to achieve the science goals set out above. Additional information about the target journal and the timeline is very useful.  This section should not exceed #1 words.}
			{#2}
		\end{SectionBox}
	}

% A framed box containing the technical justification.
\newcommand{\TechnicalJustification}[2]
	{
		\begin{SectionBox}
			{TECHNICAL JUSTIFICATION}
			{This section should not exceed #1 words. It needs to describe the overall observing strategy and to demonstrate that you understand the overheads involved in the observations and hence a justification of the total time requested.}
			{#2}
		\end{SectionBox}
	}

\newcommand{\PreviousObservations}[2]
	{
		\begin{SectionBox}
			{PREVIOUS OBSERVATIONS}
			{This section should not exceed #1 words. List any previous proposals on this source and current results, including multiwavelength information if relevant. Figures related to previous observations should be included here.}
			{#2}
		\end{SectionBox}
	}

 
% A framed box containing the references.
\newcommand{\References}[1]
	{
		\begin{SectionBox}
			{REFERENCES}
			{A list of all relevant references.}
			{#1}
		\end{SectionBox}
	}

% A framed box containing any additional figures and graphics.
\newcommand{\AdditionalFigures}[2]
	{
		\begin{SectionBox}
			{ADDITIONAL RELEVANT FIGURES AND GRAPHICS}
			{Any additional figures or graphics not already included in the text boxes can be placed here, provided the 5 page limit is maintained.}
			{#2}
		\end{SectionBox}
	}

% A framed box containing any additional figures and graphics.
\newcommand{\Theses}[2]
	{
		\begin{SectionBox}
			{THESES ASSOCIATED WITH PROPOSAL}
			{If there are any theses associated with this proposal, please list them below.}
			{#2}
		\end{SectionBox}
	}
